import{r as s,j as e,i as n,y as se}from"./index-CqnK1jY6.js";import{g as ae,B as _,X as P,Y as S,f as re,R as E,L as ne,C as w,T as L,a as ie,m as ce}from"./LineChart-f3Pg8cvh.js";import"./tiny-invariant-CopsF_GD.js";var de=ae({chartName:"BarChart",GraphicalChild:_,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:P},{axisType:"yAxis",AxisComp:S}],formatAxisMap:re});const oe=({range:i})=>{const[o,l]=s.useState([]),[c,h]=s.useState(!1);return s.useEffect(()=>{(async()=>{h(!0);try{const u={headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}},g=await n.get(`/adminPanel/sales-trend/?range=${i}`,u);l(g.data)}catch(d){console.error("Error fetching sales trend:",d)}h(!1)})()},[i]),c?e.jsx("div",{children:"Loading sales trend..."}):e.jsx(E,{width:"100%",height:300,children:e.jsxs(ne,{data:o,children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(P,{dataKey:"month"}),e.jsx(S,{}),e.jsx(L,{}),e.jsx(ie,{type:"monotone",dataKey:"sales",stroke:"#8884d8",strokeWidth:3})]})})},le=()=>{const[i,o]=s.useState([]),[l,c]=s.useState(!1);return s.useEffect(()=>{(async()=>{c(!0);try{const d={headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}},u=await n.get("/adminPanel/user-engagement/",d);o(u.data)}catch(x){console.error("Error fetching user engagement:",x)}c(!1)})()},[]),l?e.jsx("div",{children:"Loading user engagement..."}):e.jsx(E,{width:"100%",height:300,children:e.jsxs(de,{data:i,children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(P,{dataKey:"date"}),e.jsx(S,{}),e.jsx(L,{}),e.jsx(_,{dataKey:"visits",fill:"#82ca9d"})]})})},me=()=>{const[i,o]=s.useState("6m"),[l,c]=s.useState(0),[h,x]=s.useState(0),[d,u]=s.useState(0),[g,V]=s.useState(0),[$,M]=s.useState(0),[y,O]=s.useState([]),[D,B]=s.useState(0),[R,U]=s.useState([]),[T,I]=s.useState([]),[N,K]=s.useState([]),[C,z]=s.useState(1),[b,G]=s.useState(1),[A,X]=s.useState(1),[k,Y]=s.useState(1),f=5;s.useEffect(()=>{(async()=>{const a=localStorage.getItem("access_token");if(!a)return;const r={headers:{Authorization:`Bearer ${a}`}};try{const[j,F,W,q,H,v,J,Q]=await Promise.all([n.get("/adminPanel/total-products/",r),n.get("/adminPanel/total-sales/",r),n.get("/adminPanel/users/",r),n.get("/adminPanel/total-orders/",r),n.get("/adminPanel/top-products/",r),n.get("/adminPanel/visitor-analytics/",r),n.get("/adminPanel/recent-orders/",r),n.get("/adminPanel/total-refunds/",r)]);x(j.data.total_products),M(F.data.total_sales),V(W.data.length),u(q.data.total_orders),O(H.data),K(J.data.recent_order_data),c(Q.data);const Z=(v.data.recent_visits_data||[]).reduce((ee,te)=>ee+te.count,0);B(Z),U(v.data.top_products||[]),I(v.data.top_referrers||[])}catch{se.error("Failed to load admin statistics.")}})()},[]);const m=(t,a)=>{const r=(a-1)*f;return t.slice(r,r+f)},p=(t,a,r)=>{const j=Math.ceil(t/f);return e.jsxs("div",{className:"pagination",children:[e.jsx("button",{onClick:()=>r(Math.max(1,a-1)),disabled:a===1,children:"Previous"}),e.jsxs("span",{children:["Page ",a," of ",j]}),e.jsx("button",{onClick:()=>r(Math.min(j,a+1)),disabled:a===j,children:"Next"})]})};return e.jsx("div",{className:"report-management",children:e.jsxs("div",{className:"report-container",children:[e.jsx("div",{className:"report-summary-grid",children:[{title:"Total Sales",value:`$${$}`},{title:"Orders",value:d},{title:"New Customers",value:g},{title:"Refunds",value:`$${l}`},{title:"Products Sold",value:h},{title:"Site Visits",value:D}].map((t,a)=>e.jsxs(ce.div,{className:"report-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:a*.1},children:[e.jsx("h3",{children:t.title}),e.jsx("p",{className:typeof t.value=="number"&&t.value>0?"":"value",children:t.value})]},t.title))}),e.jsxs("div",{className:"report-section",children:[e.jsx("h2",{children:"ðŸ“Š Monthly Sales Trend"}),e.jsxs("div",{children:[e.jsx("label",{children:"Range: "}),e.jsxs("select",{title:"range",value:i,onChange:t=>o(t.target.value),children:[e.jsx("option",{value:"3m",children:"Last 3 Months"}),e.jsx("option",{value:"6m",children:"Last 6 Months"}),e.jsx("option",{value:"12m",children:"Last 12 Months"})]})]}),e.jsx(oe,{range:i})]}),e.jsxs("div",{className:"report-section",children:[e.jsx("h2",{children:"ðŸ“ˆ User Engagement"}),e.jsx(le,{})]}),e.jsxs("div",{className:"report-section",children:[e.jsx("h2",{children:"ðŸ‘€ Top Viewed Products"}),e.jsxs("table",{className:"report-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product URL"}),e.jsx("th",{children:"Views"})]})}),e.jsx("tbody",{children:m(R,C).map((t,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:t.path}),e.jsx("td",{children:t.count})]},a))})]}),p(R.length,C,z)]}),e.jsxs("div",{className:"report-section",children:[e.jsx("h2",{children:"ðŸŒ Top Referrers"}),e.jsxs("table",{className:"report-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Referrer"}),e.jsx("th",{children:"Visits"})]})}),e.jsx("tbody",{children:m(T,b).map((t,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:t.referrer}),e.jsx("td",{children:t.count})]},a))})]}),p(T.length,b,G)]}),e.jsxs("div",{className:"report-section",children:[e.jsx("h2",{children:"ðŸ† Top Products"}),e.jsxs("table",{className:"report-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product Name"}),e.jsx("th",{children:"Units Sold"}),e.jsx("th",{children:"Revenue"})]})}),e.jsx("tbody",{children:m(y,A).map((t,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:t.name}),e.jsx("td",{children:t.popularity}),e.jsxs("td",{children:["$",t.sales]})]},a))})]}),p(y.length,A,X)]}),e.jsxs("div",{className:"report-section",children:[e.jsx("h2",{children:"ðŸ›’ Recent Orders"}),e.jsxs("table",{className:"report-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order ID"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:m(N,k).map((t,a)=>e.jsxs("tr",{children:[e.jsxs("td",{children:["#",t.id]}),e.jsx("td",{children:t.user}),e.jsx("td",{children:t.created_at}),e.jsxs("td",{children:["$",t.total_price]}),e.jsx("td",{children:t.status})]},a))})]}),p(N.length,k,Y)]})]})})};export{me as default};

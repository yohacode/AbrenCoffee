import{u as $,a as E,r as l,j as e,i,y as n}from"./index-C2yyB8IZ.js";import{S as P}from"./react-select.esm-BbPDZ92l.js";const _="http://127.0.0.1:8000",A=()=>{const{id:c}=$(),d=E(),[v,S]=l.useState(!0),[C,B]=l.useState([]),[N,k]=l.useState(null),[u,g]=l.useState(""),[h,p]=l.useState(""),[r,m]=l.useState(null),[b,w]=l.useState(null),[f,x]=l.useState(null),[j,y]=l.useState(!1);l.useEffect(()=>{(async()=>{try{const o=localStorage.getItem("access_token"),s=(await i.get(`/blog/detail/${c}/`,{headers:{Authorization:`Bearer ${o}`}})).data.blog;k(s),g(s.title),p(s.content),m(s.category?{id:s.category.id,name:s.category.name}:null),y(s.is_published),x(s.image.startsWith("http")?s.image:`${_}${s.image}`)}catch{n.error("❌ Failed to load blog data.")}finally{S(!1)}})()},[c]),l.useEffect(()=>{(async()=>{try{const o=localStorage.getItem("access_token"),a=await i.get("/blog/category/",{headers:{Authorization:`Bearer ${o}`}});B(a.data)}catch{n.error("❌ Failed to load categories.")}})()},[]);const I=t=>{t&&m({id:t.value,name:t.label})},U=async t=>{t.preventDefault();try{if(!r)return n.error("Please select a category.");const o=localStorage.getItem("access_token"),a=new FormData;a.append("title",u),a.append("content",h),a.append("category",r.id.toString()),a.append("is_published",j?"true":"false"),b&&a.append("image",b);const s=await i.put(`/blog/update/${c}/`,a,{headers:{Authorization:`Bearer ${o}`}});n.success("✅ Blog updated successfully!"),console.log("Update response:",s.data),d(-2)}catch(o){console.error(o),n.error("❌ Failed to update blog.")}};return v?e.jsx("div",{className:"center-text",children:"Loading blog info..."}):N?e.jsxs("div",{className:"update-container",children:[e.jsx("h2",{className:"update-title",children:"Update Blog"}),e.jsxs("form",{onSubmit:U,className:"update-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Title"}),e.jsx("input",{value:u,onChange:t=>g(t.target.value),required:!0,placeholder:"Enter blog title"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Content"}),e.jsx("textarea",{value:h,onChange:t=>p(t.target.value),required:!0,placeholder:"Enter blog content"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Image"}),f&&e.jsx("img",{src:f,alt:"Preview",style:{width:"120px",marginBottom:"8px",borderRadius:"6px"}}),e.jsx("input",{title:"Upload an image",accept:"image/*",type:"file",onChange:t=>{var a;const o=(a=t.target.files)==null?void 0:a[0];o&&(w(o),x(URL.createObjectURL(o)))}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsx(P,{placeholder:"Select category",options:C.map(t=>({value:t.id,label:t.name})),onChange:I,value:r?{value:r.id,label:r.name}:null})]}),e.jsxs("div",{className:"form-checkbox",children:[e.jsx("input",{placeholder:"publish",type:"checkbox",checked:j,onChange:t=>y(t.target.checked)}),e.jsx("label",{children:"Publish"})]}),e.jsxs("div",{className:"button-group",children:[e.jsx("button",{type:"button",onClick:()=>d(-1),className:"back-button",children:"← Back"}),e.jsx("button",{type:"submit",className:"submit-button",children:"Update Blog"})]})]})]}):e.jsx("div",{className:"center-text error",children:"Blog not found"})};export{A as default};

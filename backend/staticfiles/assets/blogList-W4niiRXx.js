import{a as S,r as a,j as e,F as A,i as j,y as m}from"./index-Bccf4OWe.js";import{C as k}from"./confirmDelete-C0Va7e4M.js";const P=()=>{const f=S(),[C,n]=a.useState(!1),[o,c]=a.useState([]),[i,b]=a.useState(""),[d,y]=a.useState(1),r=5;a.useEffect(()=>{(async()=>{const s=localStorage.getItem("access_token");try{const l=await j.get("/blog/list/",{headers:{Authorization:`Bearer ${s}`}});c(l.data)}catch(l){console.error("Failed to fetch blogs:",l)}})()},[]);const p=()=>n(!0),B=async t=>{n(!1);const s=localStorage.getItem("access_token");try{await j.delete(`/blog/delete/${t}/`,{headers:{Authorization:`Bearer ${s}`}}),m.success("✅ Blog deleted successfully!"),c(o.filter(l=>l.id!==t))}catch{m.error("❌ Failed to delete blog.")}},h=o.filter(t=>t.title.toLowerCase().includes(i.toLowerCase())),x=d*r,u=x-r,g=h.slice(u,x),N=Math.ceil(h.length/r);return e.jsxs("div",{className:"blog-list",children:[e.jsx("h2",{children:"All Blogs"}),e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Search by title...",value:i,onChange:t=>b(t.target.value),className:"search-input"})}),e.jsx("div",{className:"blog-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Author"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:g.length>0?g.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{children:u+s+1}),e.jsx("td",{children:t.title}),e.jsx("td",{children:t.author_username||`User ${t.author}`}),e.jsx("td",{children:t.category_name}),e.jsx("td",{children:new Date(t.created_at).toLocaleString()}),e.jsxs("td",{children:[e.jsx("button",{title:"edit",className:"btn-edit",onClick:()=>f(`/adminPage/blog/detail/${t.id}`),children:e.jsx(A,{})}),e.jsx("button",{className:"btn-delete",onClick:p,children:"🗑️"})]}),e.jsx(k,{isOpen:C,title:"Delete blog",message:"Are you sure you want to delete this blog? This action cannot be undone.",onConfirm:()=>B(Number(t.id)),onCancel:()=>n(!1)})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center",children:"No blogs found."})})})]})}),e.jsx("div",{className:"pagination",children:[...Array(N).keys()].map(t=>e.jsx("button",{onClick:()=>y(t+1),className:d===t+1?"active":"",children:t+1},t+1))})]})};export{P as default};

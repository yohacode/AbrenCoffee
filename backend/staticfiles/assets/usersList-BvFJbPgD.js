import{r as n,a as P,j as e,i as p,y as g}from"./index-Bccf4OWe.js";import{C as $}from"./confirmDelete-C0Va7e4M.js";const T=()=>{const[C,a]=n.useState(!1),[c,i]=n.useState([]),[o,S]=n.useState(""),[d,N]=n.useState(1),l=5,y=P();n.useEffect(()=>{(async()=>{const r=localStorage.getItem("access_token"),t=await p.get("/users/users/",{headers:{Authorization:`Bearer ${r}`}});i(t.data)})()},[]);const h=c.filter(s=>s.user.username.toLowerCase().includes(o.toLowerCase())),u=d*l,x=u-l,j=h.slice(x,u),b=Math.ceil(h.length/l),U=()=>a(!0),v=async s=>{a(!1);const r=localStorage.getItem("access_token");try{await p.delete(`/users/delete/${s}/`,{headers:{Authorization:`Bearer ${r}`}}),g.success("✅ User deleted successfully!"),i(c.filter(t=>t.id!==s.toString()))}catch{g.error("❌ Failed to delete user.")}};return e.jsxs("div",{className:"users-list",children:[e.jsx("h2",{children:"All Users"}),e.jsx("div",{className:"search-bar",children:e.jsx("input",{type:"text",placeholder:"Search by username...",value:o,onChange:s=>S(s.target.value)})}),e.jsx("div",{className:"users-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Shipping Address Count"}),e.jsx("th",{children:"Total Spent ($)"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:j.length>0?j.map((s,r)=>{const{user:t,shipping_address:m,total_spent:A}=s,k=A;return e.jsxs("tr",{children:[e.jsx("td",{children:x+r+1}),e.jsx("td",{children:t.username}),e.jsx("td",{children:t.email}),e.jsx("td",{children:t.role}),e.jsx("td",{children:m.length>0?m.map((f,w)=>e.jsxs("div",{children:[f.address1||"No address info",", ",f.street||"No street info"]},w)):e.jsx("span",{children:"No address"})}),e.jsxs("td",{children:["$",k]}),e.jsxs("td",{children:[e.jsx("button",{className:"btn-edit",onClick:()=>y(`/adminPage/users/detail/${t.id}`),children:"✏️"}),e.jsx("button",{className:"btn-delete",onClick:U,children:"🗑️"})]}),e.jsx($,{isOpen:C,title:"Delete user",message:"Are you sure you want to delete this user? This action cannot be undone.",onConfirm:()=>v(t.id),onCancel:()=>a(!1)})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center",children:"No users found."})})})]})}),e.jsx("div",{className:"pagination",children:[...Array(b).keys()].map(s=>e.jsx("button",{onClick:()=>N(s+1),className:d===s+1?"active":"",children:s+1},s+1))})]})};export{T as default};

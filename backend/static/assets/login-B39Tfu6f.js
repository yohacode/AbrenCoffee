import{r as t,a as S,j as e,i as c,y as u}from"./index-hTbnu1AZ.js";import{B as N}from"./backbutton-CBbjLY6n.js";import{P as w}from"./viewPassword-D5r2I4QL.js";const k=()=>{const[r,d]=t.useState(""),[n,m]=t.useState(""),[g,o]=t.useState(!1),[i,h]=t.useState(null),a=S();t.useEffect(()=>{(async()=>{try{(await c.get("/api/auth/status/",{withCredentials:!0})).data.isAuthenticated&&a(-1)}catch{u.error("Session check failed:")}})()},[a]);const p=async s=>{s.preventDefault(),h(null),o(!0);try{const l=await c.post("/api/login/",{username:r,password:n}),{access:x,refresh:f,email:j,username:v}=l.data;localStorage.setItem("access_token",x),localStorage.setItem("refresh_token",f),localStorage.setItem("email",j),localStorage.setItem("username",v),localStorage.setItem("isLoggedIn","true"),a("/")}catch{u.error("Login failed. Please try again."),a(-1)}finally{o(!0)}};return g?e.jsxs("div",{className:"main",children:[e.jsx("div",{className:"outer",children:e.jsx("div",{className:"inner"})}),"Loaging In..."]}):e.jsxs("div",{className:"login-container",children:[e.jsx(N,{}),e.jsx("h2",{className:"login-title",children:"Login"}),e.jsxs("form",{onSubmit:p,className:"login-box",children:[e.jsx("input",{type:"text",value:r,onChange:s=>d(s.target.value),placeholder:"Username",className:"login-input",required:!0}),e.jsx(w,{name:"password",value:n,onChange:s=>m(s.target.value),placeholder:"Password",className:"login-input",required:!0}),e.jsx("button",{type:"submit",className:"login-button",children:"Login"})]}),i&&e.jsx("div",{className:"error-message",children:i}),e.jsx("div",{className:"login-footer",children:e.jsxs("p",{onClick:()=>a("/forgot-password"),children:["Forgot your password? ",e.jsx("span",{children:"Reset here"})]})})]})};export{k as default};

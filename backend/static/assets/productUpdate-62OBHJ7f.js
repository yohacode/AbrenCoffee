import{u as _,a as L,r as s,j as e,i as q,y as o}from"./index-Bccf4OWe.js";const B=()=>{const{id:n}=_(),C=L(),[I,w]=s.useState(null),[U,u]=s.useState(!0),[c,l]=s.useState(!1),[d,p]=s.useState(""),[m,g]=s.useState(0),[h,x]=s.useState(""),[f,j]=s.useState(""),[v,y]=s.useState(0),[b,S]=s.useState(""),[N,$]=s.useState(null),[k,P]=s.useState(null);s.useEffect(()=>{(async()=>{try{u(!0);const a=localStorage.getItem("access_token"),r=(await q.get(`/products/detail/${n}/`,{headers:{Authorization:`Bearer ${a}`}})).data;w(r),p(r.name),g(r.price),x(r.category),j(r.stock),y(r.quantity),S(r.description),l(r.is_subscription),P(r.image.startsWith("http")?r.image:`undefined${r.image}`)}catch{o.error("Fetch failed: ")}finally{u(!1)}})()},[n]);const D=async t=>{t.preventDefault();const a=new FormData;a.append("name",d),a.append("description",b),a.append("category",h),a.append("stock",f),a.append("price",m.toString()),a.append("quantity",v.toString()),a.append("is_subscription",c?"true":"false"),N&&a.append("image",N);try{const i=localStorage.getItem("access_token");await q.put(`/products/update/${n}`,a,{headers:{Authorization:`Bearer ${i}`}}),o.success("Product updated successfully"),C(-2)}catch{o.error("Update failed: ")}};return U?e.jsx("div",{className:"center-text",children:"Loading product info..."}):I?e.jsxs("div",{className:"update-container",children:[e.jsx("h2",{className:"update-title",children:"Update Product"}),e.jsxs("form",{onSubmit:D,className:"update-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Name"}),e.jsx("input",{type:"text",title:"name",value:d,onChange:t=>p(t.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Price"}),e.jsx("input",{type:"number",title:"price",value:m,onChange:t=>g(parseFloat(t.target.value)),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Image"}),k&&e.jsx("img",{src:k,alt:"Preview",style:{width:"12em",marginBottom:"8px",borderRadius:"6px"}}),e.jsx("input",{type:"file",title:"image",onChange:t=>{var i;const a=(i=t.target.files)==null?void 0:i[0];a&&($(a),P(URL.createObjectURL(a)))},required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("input",{type:"text",title:"description",value:b,onChange:t=>S(t.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsx("input",{type:"text",title:"category",value:h,onChange:t=>x(t.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Stock"}),e.jsx("input",{type:"text",title:"stock",value:f,onChange:t=>j(t.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Quantity"}),e.jsx("input",{type:"text",title:"quantity",value:v,onChange:t=>y(Number(t.target.value)),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Is Subscription"}),e.jsx("input",{type:"checkbox",title:"is_subscription",checked:c,value:c?"true":"false",onChange:t=>l(t.target.checked)})]}),e.jsx("button",{type:"submit",className:"submit-button",children:"Update Product"})]})]}):e.jsx("div",{className:"center-text error",children:"Product not found"})};export{B as default};

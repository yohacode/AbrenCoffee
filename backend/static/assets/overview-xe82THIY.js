import{r as t,j as s,i as r,y as ss}from"./index-P8e0zQCF.js";import{R as es,L as ts,C as as,X as rs,Y as ls,T as ds,a as cs}from"./LineChart-ZSH4MpAn.js";import"./tiny-invariant-CopsF_GD.js";const hs=()=>{const[N,k]=t.useState([]),[n,L]=t.useState([]),[R,C]=t.useState(0),[i,_]=t.useState(0),[w,T]=t.useState(0),[O,b]=t.useState(0),[A,D]=t.useState(0),[E,$]=t.useState(0),[F,Y]=t.useState(0),[o,h]=t.useState(null),[c,I]=t.useState(""),[x,j]=t.useState(1),[u,m]=t.useState(1),[K,p]=t.useState(!0),l=5;t.useEffect(()=>{(async()=>{const d=localStorage.getItem("access_token");if(!d){h("You must be logged in."),p(!1);return}const a={headers:{Authorization:`Bearer ${d}`}};try{const[B,G,W,q,H,J,Q,V,Z]=await Promise.all([r.get("/adminPanel/total-products/",a),r.get("/adminPanel/total-stock/",a),r.get("/adminPanel/total-sales/",a),r.get("/adminPanel/users/",a),r.get("/adminPanel/total-orders/",a),r.get("/adminPanel/completed_orders/",a),r.get("/adminPanel/top-products/",a),r.get("/adminPanel/sales-per-day/",a),r.get("/adminPanel/total-refunds/",a)]);C(B.data.total_products),_(G.data.total_stock),T(W.data.total_sales),Y(q.data.length),b(H.data.total_orders),$(J.data.total_completed_orders),k(Q.data),L(V.data.sales_per_day||[]),D(Z.data)}catch{ss.error("Error fetching admin data."),h("Failed to load admin statistics.")}finally{p(!1)}})()},[]),t.useEffect(()=>{j(1),m(1)},[c]);const S=N.filter(e=>e.name.toLowerCase().includes(c.toLowerCase())),P=n.filter(e=>e.total_sales>0&&e.day.toLowerCase().includes(c.toLowerCase())),M=Math.ceil(S.length/l),g=x*l,U=g-l,f=S.slice(U,g),X=Math.ceil(P.length/l),y=u*l,z=y-l,v=P.slice(z,y);return K?s.jsx("div",{className:"overview loading",children:"Loading..."}):s.jsx("div",{className:"overview",children:s.jsxs("div",{className:"cards-container",children:[o&&s.jsx("div",{className:"alert alert-danger w-100 text-center",children:o}),s.jsxs("div",{className:"cards",children:[s.jsxs("div",{className:"card",children:[s.jsx("p",{children:R}),s.jsx("h2",{children:"Total Products"}),s.jsxs("small",{className:i<10?"less-stock":"",children:[s.jsx("p",{children:"Stock"}),s.jsx("p",{children:i})]})]}),s.jsxs("div",{className:"card",children:[s.jsxs("p",{children:["$",w]}),s.jsx("h2",{children:"Total Sales"}),s.jsxs("small",{children:[s.jsx("p",{children:"Refund"}),s.jsxs("p",{children:["$",A]})]})]}),s.jsxs("div",{className:"card",children:[s.jsx("p",{children:F}),s.jsx("h2",{children:"Total Users"}),s.jsxs("small",{children:[s.jsx("p",{children:"New"}),s.jsx("p",{children:"0"})]})]}),s.jsxs("div",{className:"card",children:[s.jsx("p",{children:O.toLocaleString()}),s.jsx("h2",{children:"Total Orders"}),s.jsxs("small",{children:[s.jsx("p",{children:"Completed"}),s.jsx("p",{children:E})]})]})]}),s.jsxs("div",{className:"users-top-products",children:[s.jsxs("div",{className:"top-products",children:[s.jsxs("div",{className:"top-product-head",children:[s.jsx("h3",{children:"Top Products"}),s.jsx("div",{className:"search-bar",children:s.jsx("input",{type:"text",placeholder:"Search...",value:c,onChange:e=>I(e.target.value)})})]}),s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"#"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Popularity"}),s.jsx("th",{children:"Sales"})]})}),s.jsx("tbody",{children:f.length>0?f.map((e,d)=>s.jsxs("tr",{children:[s.jsx("td",{children:d+1}),s.jsx("td",{children:e.name}),s.jsxs("td",{children:[e.popularity,"%"]}),s.jsxs("td",{children:["$",e.sales.toLocaleString()]})]},e.id)):s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"text-center",children:"No top products found."})})})]}),s.jsx("div",{className:"pagination",children:[...Array(M).keys()].map(e=>s.jsx("button",{onClick:()=>j(e+1),className:x===e+1?"active":"",children:e+1},e+1))})]}),s.jsxs("div",{className:"sales-per-day",children:[s.jsx("h3",{children:"Sales Per Day"}),s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Date"}),s.jsx("th",{children:"Total Sales"})]})}),s.jsx("tbody",{children:v.length>0?v.map((e,d)=>s.jsxs("tr",{children:[s.jsx("td",{children:e.day}),s.jsxs("td",{children:["$",e.total_sales]})]},d)):s.jsx("tr",{children:s.jsx("td",{colSpan:2,children:"No daily sales data found."})})})]}),s.jsx("div",{className:"pagination",children:[...Array(X).keys()].map(e=>s.jsx("button",{onClick:()=>m(e+1),className:u===e+1?"active":"",children:e+1},e+1))})]})]}),s.jsx("div",{className:"sales-chart",children:s.jsxs("div",{className:"sales-per-day-chart",children:[s.jsx("h3",{children:"Sales Per Day"}),s.jsx(es,{width:"100%",height:300,children:s.jsxs(ts,{data:n,children:[s.jsx(as,{strokeDasharray:"3 3"}),s.jsx(rs,{dataKey:"day"}),s.jsx(ls,{}),s.jsx(ds,{}),s.jsx(cs,{type:"monotone",dataKey:"total_sales",stroke:"#8884d8",strokeWidth:2})]})})]})})]})})};export{hs as default};

import{j as e,r as l,u as y,a as C,i as v}from"./index-Bccf4OWe.js";const S=({categories:n,setCategory:i,allCat:t})=>n.length?e.jsx("div",{className:"blog-categories",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx("button",{className:"li",onClick:()=>t,children:"All Articles"})}),n.map(o=>e.jsx("li",{children:e.jsx("button",{className:"li",onClick:()=>i(o.id),children:o.name})},o.id))]})}):e.jsx("p",{children:"Loading categories..."}),k=()=>{const[n,i]=l.useState(!0),[t,o]=l.useState([]),{id:d}=y(),[a,g]=l.useState(null),c=C(),m=l.useRef(0),[p,f]=l.useState(!1),h=()=>{const s=window.scrollY;f(s>m.current),m.current=s};l.useEffect(()=>(window.addEventListener("scroll",h),()=>window.removeEventListener("scroll",h)),[]),l.useEffect(()=>{g(d?parseInt(d):null)},[d]),l.useEffect(()=>{const s=localStorage.getItem("access_token");(async j=>{try{const u=await v.get("/blog/list/",{headers:s?{Authorization:`Bearer ${s}`}:{},withCredentials:!0,params:j?{category:j}:{}});o(u.data)}catch(u){console.error("Failed to fetch blog data:",u)}finally{i(!1)}})(a!==null?a:void 0)},[a]);const x=s=>{g(s),c(s===null?"/blog":`/blog/category/${s}`)},b=l.useMemo(()=>a?t.filter(s=>Number(s.category)===a):t,[a,t]),N=l.useMemo(()=>[...new Map(t.map(r=>[r.category,{id:Number(r.category),name:r.category_name,link:`/blog/category/${r.category}`}])).values()],[t]);return e.jsxs("section",{className:"blog",children:[e.jsx("header",{className:p?"blog-hero scroll":"blog-hero",children:e.jsxs("div",{className:"blog-header-content",children:[e.jsx("h1",{className:"blog-title",children:"Abren Coffee Insights"}),e.jsx("p",{className:"blog-subtitle",children:"Explore expert takes, brewing tips, and stories behind your favorite blends."})]})}),e.jsxs("main",{className:"blog-container",children:[e.jsx("div",{className:"blog-catagory-menu",children:e.jsx(S,{allCat:()=>x(null),categories:N,setCategory:x})}),n?e.jsx("p",{className:"blog-loading",children:"Loading posts..."}):b.length===0?e.jsx("p",{className:"blog-empty",children:"No blog posts found in this category."}):e.jsx("div",{className:"blog-grid",children:b.filter(s=>s.image).map(s=>e.jsxs("article",{className:"blog-card",onClick:()=>c(`/blog/detail/${s.id}`),children:[e.jsx("img",{src:s.image,alt:s.title,className:"blog-img"}),e.jsxs("div",{className:"blog-content",children:[e.jsx("h2",{className:"blog-title",children:s.title}),e.jsx("p",{className:"category",children:s.category_name}),e.jsxs("p",{className:"blog-meta",children:["By ",e.jsx("strong",{children:s.author_username})," Â·"," ",new Date(s.created_at).toLocaleDateString()]}),e.jsxs("p",{className:"blog-snippet",children:[s.content.slice(0,320),"..."]}),e.jsx("button",{className:"blog-readmore",onClick:()=>c(`blog/detail/${s.id}`),children:"Read more"})]})]},s.id))})]})]})};export{k as default};

import{r as c,j as e,i as v,y as f,b as F}from"./index-hTbnu1AZ.js";import{S as q}from"./react-select.esm-Ci4g_JSt.js";const P=()=>{const[t,i]=c.useState(!1),p=c.useRef(null),[y,n]=c.useState({name:""}),x=u=>{const{name:l,type:r,value:g,checked:C,files:d}=u.target;r==="file"&&(d!=null&&d[0])?n(m=>({...m,image:d[0]})):n(r==="checkbox"?m=>({...m,[l]:C}):m=>({...m,[l]:g}))},j=async u=>{u.preventDefault(),i(!0);const l=localStorage.getItem("access_token"),r=new FormData;r.append("name",y.name);try{await v.post("/products/create-category/",r,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"multipart/form-data"}}),f.success("✅ Product Category created successfully!"),n({name:""}),p.current&&(p.current.value="")}catch(g){f.error("❌ Failed to create product category. Please try again."),console.error(g)}finally{i(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:j,className:"category-form",children:[e.jsx("h2",{children:"Create Blog Category"}),e.jsx("div",{className:"form-group",children:e.jsx("input",{type:"text",name:"name",placeholder:"name",value:y.name,onChange:x,className:"form-input",required:!0})}),e.jsx("button",{type:"submit",disabled:t,className:"category-form-button",children:t?"Submitting...":"Create Blog Category"})]})})},I=()=>{const[t,i]=c.useState({name:"",category:"",stock:0,quantity:0,description:"",price:0,image:""}),[p,y]=c.useState([]),[n,x]=c.useState(!1),[j,u]=c.useState(!1),l=c.useRef(null);c.useEffect(()=>{(async()=>{try{const s=await v.get("/products/list-category/");y(s.data.map(a=>({label:a.name,value:a.id})))}catch(s){console.error("Failed to fetch categories",s),f.error("❌ Failed to load categories")}})()},[n]);const r=o=>{const{name:s,type:a,value:N,checked:k,files:b}=o.target;a==="file"&&(b!=null&&b[0])?i(h=>({...h,image:b[0]})):i(a==="checkbox"?h=>({...h,[s]:k}):h=>({...h,[s]:N}))},g=o=>{i(s=>({...s,category:o?String(o.value):""}))},C=async o=>{o.preventDefault(),u(!0);const s=localStorage.getItem("access_token"),a=new FormData;a.append("name",t.name),a.append("description",t.description),a.append("stock",String(t.stock)),a.append("quantity",String(t.quantity)),a.append("price",String(t.price)),a.append("category",t.category),t.image instanceof File&&a.append("image",t.image);try{await v.post("/products/create/",a,{headers:{Authorization:`Bearer ${s}`,"Content-Type":"multipart/form-data"}}),f.success("✅ Product created successfully!"),i({name:"",category:"",stock:0,quantity:0,description:"",price:0,image:""}),l.current&&(l.current.value="")}catch(N){f.error("❌ Failed to create product. Please try again."),console.error(N)}finally{u(!1)}},d=()=>{x(!n)},m=()=>{x(!n)},S=()=>e.jsxs("div",{className:"category-create",children:[e.jsx("button",{className:"close-btn",onClick:m,children:"×"}),e.jsx(P,{})]});return e.jsxs("div",{className:"product-form",children:[e.jsx("h2",{children:"Create New Product"}),e.jsxs("form",{onSubmit:C,className:"form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Name:"}),e.jsx("input",{type:"text",name:"name",placeholder:"Product Name",value:t.name,onChange:r,className:"form-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"description",children:"Description:"}),e.jsx("textarea",{name:"description",placeholder:"Product Description",value:t.description,onChange:r,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"image",children:"Image:"}),e.jsx("input",{type:"file",name:"image",placeholder:"image",title:"product image",ref:l,onChange:r,accept:"image/*",className:"form-input"}),t.image instanceof File&&e.jsx("img",{src:URL.createObjectURL(t.image),alt:"Preview",className:"form-preview"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"stock",children:"Stock:"}),e.jsx("input",{type:"number",name:"stock",placeholder:"stock",title:"number of items in stock",value:t.stock,onChange:r,className:"form-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"quantity",children:"Quantity:"}),e.jsx("input",{type:"number",name:"quantity",placeholder:"quantity",title:"number of items in quantity",value:t.quantity,onChange:r,className:"form-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"price",children:"Price:"}),e.jsx("input",{type:"number",title:"price in USD",placeholder:"price",name:"price",value:t.price,onChange:r,className:"form-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"category",children:"Category:"}),e.jsx(q,{placeholder:"Select category",options:p,onChange:g,className:"form-select",value:p.find(o=>o.value===Number(t.category))||null}),e.jsxs("button",{type:"button",className:"add-category-btn",onClick:()=>d(),children:[e.jsx(F,{})," Add Category"]})]}),e.jsx("button",{type:"submit",disabled:j,className:"form-button",children:j?"Submitting...":"Create Product"})]}),n&&e.jsx("div",{className:"category-create-modal",children:S()})]})};export{I as default};

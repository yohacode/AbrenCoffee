import{r as l,j as e,i as N,y as h,b as R}from"./index-DrOKnMkI.js";import{S as k}from"./react-select.esm-WdFkTFAn.js";const F=()=>{const[a,o]=l.useState(!1),p=l.useRef(null),[g,t]=l.useState({name:""}),x=m=>{const{name:i,type:r,value:b,checked:v,files:d}=m.target;r==="file"&&(d!=null&&d[0])?t(u=>({...u,image:d[0]})):t(r==="checkbox"?u=>({...u,[i]:v}):u=>({...u,[i]:b}))},j=async m=>{m.preventDefault(),o(!0);const i=localStorage.getItem("access_token"),r=new FormData;r.append("name",g.name);try{await N.post("/users/role/create/",r,{headers:{Authorization:`Bearer ${i}`,"Content-Type":"multipart/form-data"}}),h.success("✅ Role created successfully!"),t({name:""}),p.current&&(p.current.value="")}catch{h.error("❌ Failed to create role. Please try again.")}finally{o(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:j,className:"category-form",children:[e.jsx("h2",{children:"Create Role"})," ",e.jsx("div",{className:"form-group",children:e.jsx("input",{type:"text",name:"name",placeholder:"name",value:g.name,onChange:x,className:"form-input",required:!0})}),e.jsxs("button",{type:"submit",disabled:a,className:"role-form-button",children:[a?"Submitting...":"Create Role"," "]})]})})},A=()=>{const[a,o]=l.useState({username:"",email:"",password:"",role:""}),[p,g]=l.useState([]),[t,x]=l.useState(!1),[j,m]=l.useState(!1),i=l.useRef(null);l.useEffect(()=>{(async()=>{try{const c=await N.get("/users/role/list/");g(c.data.map(s=>({label:s.name,value:s.id})))}catch{h.error("❌ Failed to load roles")}})()},[t]);const r=n=>{const{name:c,type:s,value:S,checked:w,files:y}=n.target;s==="file"&&(y!=null&&y[0])?o(f=>({...f,image:y[0]})):o(s==="checkbox"?f=>({...f,[c]:w}):f=>({...f,[c]:S}))},b=n=>{o(c=>({...c,role:n?String(n.value):""}))},v=async n=>{n.preventDefault(),m(!0);const c=localStorage.getItem("access_token"),s=new FormData;s.append("username",a.username),s.append("email",a.email),s.append("password",String(a.password)),s.append("role",String(a.role));try{await N.post("/users/create/",s,{headers:{Authorization:`Bearer ${c}`,"Content-Type":"multipart/form-data"}}),h.success("✅ User Added successfully!"),o({username:"",role:"",email:"",password:""}),i.current&&(i.current.value="")}catch(S){h.error("❌ Failed to create user. Please try again."),console.error(S)}finally{m(!1)}},d=()=>{x(!t)},u=()=>{x(!t)},C=()=>e.jsxs("div",{className:"category-create",children:[e.jsx("button",{className:"close-btn",onClick:u,children:"×"}),e.jsx(F,{})]});return e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:v,className:"user-form",children:[e.jsx("h2",{children:"Add New User"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Username"}),e.jsx("input",{type:"text",name:"username",title:"username",value:a.username,onChange:r,className:"form-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Email"}),e.jsx("input",{type:"email",title:"email address",name:"email",value:a.email,onChange:r,className:"form-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Password"}),e.jsx("input",{type:"password",title:"password",name:"password",value:a.password,onChange:r,className:"form-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx(k,{placeholder:"Select role",options:p,onChange:b,className:"form-select",value:p.find(n=>n.value===Number(a.role))||null}),e.jsxs("button",{type:"button",className:"add-category-btn",onClick:()=>d(),children:[e.jsx(R,{})," Add Role"]})]}),e.jsx("button",{type:"submit",disabled:j,className:"form-button",children:j?"Submitting...":"Add User"})]}),t&&e.jsx("div",{className:"category-create-modal",children:C()})]})};export{A as default};

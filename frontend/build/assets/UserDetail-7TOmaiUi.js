import{u as E,r,j as e,i as p}from"./index-DrOKnMkI.js";const k=()=>{const{id:h}=E(),[s,x]=r.useState(null),[f,j]=r.useState(!0),[g,v]=r.useState(""),[i,l]=r.useState(null),[a,n]=r.useState("");r.useEffect(()=>{(async()=>{try{j(!0);const u=localStorage.getItem("access_token"),m=await p.get(`/users/detail/${h}`,{headers:{Authorization:`Bearer ${u}`}});if(m.status!==200)throw new Error("User not found");x(m.data)}catch{v("Failed to fetch user")}finally{j(!1)}})()},[h]);const c=t=>{s&&(l(t),n(String(s[t])))},o=()=>{l(null),n("")},d=async()=>{if(!(!s||!i))try{const t=localStorage.getItem("access_token"),u=await p.patch(`/users/update/${s.id}/`,{[i]:a},{headers:{Authorization:`Bearer ${t}`}});x(u.data),l(null),n("")}catch(t){t instanceof Error?alert("Update failed: "+t.message):alert("Update failed: An unknown error occurred")}};return f?e.jsx("div",{children:"Loading user details..."}):g?e.jsxs("div",{children:["Error: ",g]}):s?e.jsxs("div",{className:"user-detail",children:[e.jsx("h2",{children:"User Detail"}),e.jsxs("div",{className:"detail-card",children:[e.jsx("img",{src:s.profile_image,alt:""}),e.jsxs("div",{className:"user-detail-info",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",s.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",s.username]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Image:"})," ",i==="image"?e.jsxs(e.Fragment,{children:[e.jsx("input",{title:"image",type:"file",accept:"image/*",value:a,onChange:t=>n(t.target.value)}),e.jsx("button",{onClick:d,children:"Save"}),e.jsx("button",{onClick:o,children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[s.profile_image,e.jsx("button",{onClick:()=>c("profile_image"),children:"Edit"})]})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",i==="email"?e.jsxs(e.Fragment,{children:[e.jsx("input",{title:"email",type:"email",value:a,onChange:t=>n(t.target.value)}),e.jsx("button",{onClick:d,children:"Save"}),e.jsx("button",{onClick:o,children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[s.email,e.jsx("button",{onClick:()=>c("email"),children:"Edit"})]})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Role:"})," ",i==="role"?e.jsxs(e.Fragment,{children:[e.jsxs("select",{title:"role",value:a,onChange:t=>n(t.target.value),children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"staff",children:"Staff"}),e.jsx("option",{value:"customer",children:"customer"}),e.jsx("option",{value:"user",children:"User"})]}),e.jsx("button",{onClick:d,children:"Save"}),e.jsx("button",{onClick:o,children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[s.role,e.jsx("button",{onClick:()=>c("role"),children:"Edit"})]})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",s.isActive?"Active":"Inactive"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Joined:"})," ",new Date(s.date_joined).toLocaleDateString()]})]})]})]}):e.jsx("div",{children:"No user data available"})};export{k as default};
